--Question 1
select v.num_immatriculation,ma.nom_marque,mo.nom_modele
from vehicules v,modeles mo,marques ma
where v.id_modele=mo.id_modele
and mo.id_marque=ma.id_marque
and v.date_achat='2000'
and v.km_parcourus>50000;

--Question 2
select v.num_immatriculation,ma.nom_marque,mo.nom_modele
from vi villes,vehicules v,modeles mo,marques ma,agences a,dossiers d
where vi.id_ville=a.id_ville
and a.id_agence=d.id_agence_reservation
and d.id_dossier=v.id_dossier
and v.id_modele=mo.id_modele
and mo.id_marque=ma.id_marque
and d.date_retour_effectif-date_retrait>10
and to_char(d.date_retour_effectif,'MMYY')='1008'
and lower(vi.nom)='nancy';

--Question 3
select v.num_immatriculation,ma.nom_marque,mo.nom_modele
from vehicules v,modeles mo,marques ma,agences a,dossiers d,categories c
where a.id_agence=d.id_agence_reservation
and d.id_dossier=v.id_dossier
and v.id_modele=mo.id_modele
and mo.id_marque=ma.id_marque
and mo.id_categorie=c.id_categorie
and sysdate>date_retour_effectif
or sysdate<date-retrait
and lower(a.ville)='nancy'
and lower(c.nom)='c1';

--Question 4
select v.num_immatriculation,ma.nom_marque,mo.nom_modele
from vehicules v,modeles mo,marques ma,categories c,tarifs t
where v.id_modele=mo.id_modele
and mo.id_marque=ma.id_marque
and mo.id_categorie=c.id_categorie
and c.id_categorie=t.id_categorie
and t.prix_jour>30;

--Question 5
select d.id_dossier
from villes v,agences a,dossiers d
where v.id_ville=a.id_ville 
and a.id_agence=d.id_agence_retrait
and lower(v.nom)='nancy'
INTER
select d.id_dossier
from v villes,agences a,dossiers d
where v.id_ville=a.id_ville
and a.id_agence=d.id_agence_retour
and lower(v.nom)='strasbourg'


--Question 6
select immat,modele,sum(totaljourslocations)
from(
select v.num_immatriculation immat,mo.nom modele,d.date_retour_effectif-d.date_retrait totaljourslocations
from villes vi,vehicules v,agences a,dossiers d,modeles mo
where vi.id_ville=a.id_ville
and a.id_agence=v.id_agence
and v.num_immatriculation=d.num_immatriculation
and v.id_modele=mo.id_modele
and lower(vi.nom)='nancy'
)
group by immat,modele
/
 

--Question 7
SELECT id_agence
FROM AGENCES
WHERE 
	(SELECT a.id_agence, v.num_immatriculation, v.id_agence
	 FROM AGENCES a, VEHICULES v
	 WHERE sum(v.num_immatriculation)> ALL
		(SELECT sum(v.num_immatriculation), a.id_agence, v.num_immatriculation, v.id_agence
		 FROM VEHICULES v, AGENCES a));
--select a.id_agence
--from agences a,vehicules v
--where a.id_agence=v.id_agence
--and 

--Question 8

--Question 9

--Question 10
/

